# Mediator
## パターンの理解
- Mediator役が全てのコリーグ役を管理している。コリーグ役はMediatorを通して自分の状態を伝える。
- コリーグ役は相互に関係しないが、メディエイター役がコリーグ全ての状態を見ており、それによってコリーグ役やその他の状態を変化させる。

### 登場人物
- Mediator役
- コンクリートメディエイター役
- コリーグ役
- コンクリートコリーグ役

## サンプル IoTシステム
センサーと他の家電をスマートハブ（メディエーター）が管理するシステムです。
センサー・家電（コリーグ）からメディエーターにアクションのきっかけを渡し、メディエーターで家電制御の条件を管理しています。

## クラス図

<img width="777" alt="image" src="https://github.com/user-attachments/assets/ca182ca3-f876-4cbb-a9af-773c9db17fdb" />


## フィードバック
- C#ぽくない
  - 静的型付け言語、コンパイル時のチェックを最大限に効かせる、のが目的
  - stringで渡すと、厳密性がない
  - if else がバグの原因になる
  - ReeiveCommandは廃止すべき
  - 本のサンプルが良さそう
  - Mediatorは複雑で良い。コリーグはシンプルになる。
  - Receiveコマンドが困りごとになる。
  - abstractファクトリーで適用できないか？
  - コマンドをクラス化
  - アダプター、ストラテジーなどと組み合わせられる
  
## 宿題
- ReceiveCommand() をリファクタリング
- 温度センサーの追加
  
- テンプレートメソッド
  - 電源のオンオフのような共通操作をテンプレートメソッドにした *TurnOff() TurnOn()メソッド
  - オンオフ用のメソッドは作ったけどColleagueを通してメソッドを実行するようにした
  - 機器を追加する、変更する場合を考慮すると機器のセットとデバイスの型含めてabstractファクトリーが良かったかも。
  - abstractファクトリーならメディエーターから使えるメソッドがabstractファクトリーで定義されるので、機器による操作処理の違いをabstractファクトリーに任せられる
	  - シャープのエアコン・ダイキンのエアコンのような別機器を適合→アダプター(具体的な処理をそれぞれの機器に適合させる)
	  - デバイス別の操作の違い→ストラテジー(エアコン用の操作、照明用の操作)

- 問題点
  - ColleagueChanged()が呼ばれるたびに全部の条件が実行される(温度センサーからのプッシュで人感センサーの条件チェックもしている)